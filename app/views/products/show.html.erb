<h1><%= @product.name %></h1>

<%= image_tag @product.image if @product.image.present? %>

<p><%= @product.description %></p>
<p>$<%= number_with_precision(@product.price, precision: 2) %></p>

<div id="paypal-button-container"></div>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (typeof paypal === "undefined") return;

    paypal.Buttons({
      createOrder: function(data, actions) {
        return actions.order.create({
          purchase_units: [{
            amount: {
              value: "<%= @product.price %>"
            }
          }]
        });
      },

      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          alert("Payment completed by " + details.payer.name.given_name);
        });
      }
    }).render("#paypal-button-container");
  });
</script>


<%= link_to "Back", products_path %>
