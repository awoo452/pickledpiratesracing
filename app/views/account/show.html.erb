<section class="account-page">

  <div class="account-card">

    <h1>Your Account</h1>

    <div class="account-info">
      <p><strong>Email:</strong> <%= current_user.email %></p>
    </div>

    <div class="profile-details">
      <h2>Profile Details</h2>
      <p class="profile-summary">
        <strong>Name:</strong>
        <%= [current_user.first_name, current_user.last_name].compact.join(" ").presence || "Not set" %>
      </p>
      <%= link_to "Edit profile", edit_account_details_path, class: "profile-edit-link" %>
    </div>

    <h2>Your Rewards</h2>

    <% if params[:reward_claim] == "success" %>
      <p class="reward-claim success">Reward added to your account.</p>
    <% elsif params[:reward_claim] == "invalid" %>
      <p class="reward-claim error">That code didnâ€™t work. Try again.</p>
    <% end %>

    <% if @rewards.any? %>
      <ul class="rewards-list">
        <% @rewards.each do |reward| %>
          <li class="reward-item">
            <strong class="reward-title">
              <span class="reward-icon" aria-hidden="true"><%= reward_icon(reward) %></span>
              <%= reward.name %>
            </strong>
            <span><%= reward.description %></span>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="no-rewards">No rewards yet.</p>
    <% end %>

    <div class="reward-claim-form">
      <h3>Redeem Reward Code</h3>
      <%= form_with url: claim_account_reward_path, method: :post, local: true do |form| %>
        <div class="reward-claim-fields">
          <%= form.text_field :code, placeholder: "Enter reward code", aria: { label: "Reward code" } %>
          <%= form.submit "Redeem" %>
        </div>
      <% end %>
    </div>

    <div class="account-parts">
      <h2>Your Swap Meet Posts</h2>
      <%= link_to "Post a Part", new_part_path, class: "account-parts-link" %>

      <% if @parts.any? %>
        <ul class="account-parts-list">
          <% @parts.each do |part| %>
            <li class="account-part">
              <div class="account-part-details">
                <strong><%= part.part %></strong>
                <span><%= number_to_currency(part.price) %></span>
                <span><%= part.era_label %></span>
              </div>
              <%= button_to "Delete", part_path(part), method: :delete, class: "account-part-delete" %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <p class="no-rewards">No parts posted yet.</p>
      <% end %>
    </div>

  </div>

</section>
